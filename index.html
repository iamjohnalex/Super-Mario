<!DOCTYPE HTML>
<html>
<head>
<title>Super-Mario</title>
<meta charset="utf-8">
<style>
body {
	margin: 0;
	padding: 0;
	background-color: #000;
}
</style>
<script src="menu.js"></script>
<script src="part1.js"></script>
<script src="part2.js"></script>
<script src="gameover.js"></script>
<script src="//cdn.jsdelivr.net/phaser/2.6.2/phaser.min.js"></script>
</head>
<body>
	<script type="text/javascript">
		var game = new Phaser.Game(256, 240, Phaser.AUTO, '',this, false, false);  

                                        function preload(){
                                                    //  We need this because the assets are on github pages
                                                    //  Remove the next 2 lines if running locally
                                                    this.load.baseURL = 'https://iamjohnalex.github.io/Super-Mario/';
                                                    this.load.crossOrigin = 'anonymous';
                                        }
		var music;
		var scoreText;
		var ccounter;
		var cvalue=0;
		var cimage;
		var lives=3;
		var lcounter;
		var jumps;
		var stomps;
		var csound;
		var deaths;
		var score=0;
		
		
		
        
        game.state.add('gameover', gameover);
		game.state.add('part1', part1);
        game.state.add('part2', part2);
		game.state.add('menu', menu);
		game.state.start('menu');
		
		
		function  continuesOverlap(player,continues){
			if (cursors.right.isDown && (player.body.onFloor())) {
				tpsounds = game.add.audio('tpsound');
				tpsounds.play();
				player.body.enable=false;
				player.frame = 12;
				game.time.events.add(Phaser.Timer.SECOND*1.7 , function() {
					player.body.enable=true;
					game.state.start('part2');
					});
			}
		}
		
			function spikesOverlap(player,spikes){
			  if  (player.body.onFloor()) {
				GameOverText=game.add.text(189,33,'GAME OVER',{font:'25px FONT' ,fontSize: '10px', fill: 'white'});
				GameOverText.fixedToCamera=true; 
				player.frame = 6;
				player.body.enable = false;
				player.animations.stop();
				deaths=game.add.audio('death');
				music.stop();
				deaths.play();
				if(lives>1 ){
					setTimeout(function(){
				
					score=0;
					cvalue=0;
					lives-=1;
    		    		game.state.start(game.state.current);
    		   		 }, 4000);
    					} else {
				setTimeout(function(){
				
				game.state.start('gameover');
				}, 4000);}
				
				
				
			   }
		
			}
		
		
		
		
		function flagOverlap(player,flag){
			if ((player.body.onFloor())) {
			
				iamwinnerText=game.add.text(189,33,'YOU WON',{font:'25px FONT' ,fontSize: '10px', fill: 'white'});

				lives=3;
				player.frame = 11;
				player.body.enable = false;
				player.body.velocity.y = -80;
				player.animations.stop();
				music.stop();
				Wfinish.play();
				setTimeout(function(){
				game.state.start('menu');
				}, 6000);
			}
		}
		
		function pipesOverlap(player,pipes){
			if  (cursors.down.isDown && (player.body.onFloor())) {
				tpsounds = game.add.audio('tpsound');
				tpsounds.play();
				player.body.enable=false;
				player.frame = 12;
				game.time.events.add(Phaser.Timer.SECOND*1.7 , function() {
					player.body.enable=true;
					player.reset(962,1);
				});
			}
		}
		
		function coinOverlap(player, coin) {
			cvalue += 1;
			ccounter.text = 'X' + cvalue;
			score +=100;
			csound = game.add.audio('coinsc');
			Wfinish=game.add.audio('finish');
			scoreText.text='LUIGI\n'+score;
			csound.play();
			coin.kill();
		}
		
		function mageOverlap(player, mage) {
			if (player.body.touching.down) {
				mage.animations.stop();
				mage.frame = 13;
				mage.body.enable = false;
				player.body.velocity.y = -80;
				stomps = game.add.audio('stomp');
		        	stomps.play();
		        	score += 400;
    				scoreText.text = 'lUIGI\n' + score;
				game.time.events.add(Phaser.Timer.SECOND, function() {
					mage.kill();
					
				});
			}
			 else {
				GameOverText=game.add.text(189,33,'GAME OVER',{font:'25px FONT' ,fontSize: '10px', fill: 'white'});
				GameOverText.fixedToCamera=true; 
				player.frame = 6;
				player.body.enable = false;
				player.animations.stop();
				deaths=game.add.audio('death');
				music.stop();
				deaths.play();
				if(lives>1){
					setTimeout(function(){
					
					score=0;
					cvalue=0;
					lives-=1;
    		    		game.state.start(game.state.current);
    		   		 }, 4000);
    					} else {
				setTimeout(function(){
				
				game.state.start('gameover');
				}, 4000);}
			}
		}
		 
		 
		
		function goombaOverlap(player, goomba) {
			if (player.body.touching.down) {
				goomba.animations.stop();
				goomba.frame = 2;
				goomba.body.enable = false;
				player.body.velocity.y = -80;
				stomps = game.add.audio('stomp');
		        	stomps.play();
		        	score += 400;
    				scoreText.text = 'lUIGI\n' + score;
				game.time.events.add(Phaser.Timer.SECOND, function() {
					goomba.kill();
				});
			} else {
				
				GameOverText=game.add.text(189,33,'GAME OVER',{font:'25px FONT' ,fontSize: '10px', fill: 'white'});
				GameOverText.fixedToCamera=true; 
				player.frame = 6;
				player.body.enable = false;
				player.animations.stop();
				deaths=game.add.audio('death');
				music.stop();
				deaths.play();
				if(lives>1 ){
					setTimeout(function(){
				
					score=0;
					cvalue=0;
					lives-=1;
    		    		game.state.start(game.state.current);
    		   		 }, 4000);
    					} else {
				setTimeout(function(){
				
				game.state.start('gameover');
				}, 4000);}
			}
		}
	</script>
  </body>
</html>
